-- SQL_GET
SELECT a.management_no ,a.customer_code ,COALESCE(b.customer_name,'') AS customer_name ,CASE WHEN a.customer_code = '1' THEN '1' ELSE '0' END as 得意先区分 ,a.incoming_order_no ,a.branch_no ,a.part_no ,a.engineering_change_no ,a.part_name ,a.customer_part_no ,CASE WHEN c.part_no IS NULL THEN '' ELSE '管理図面' END AS 図面type ,a.manager_code ,COALESCE(d.employee_name,'') AS manager_name ,a.incoming_order_type ,a.redelivery_type ,a.incoming_order_DATE ,a.deadline ,a.incoming_order_quantity ,a.unit ,a.unit_price ,a.delivery_place_code ,a.delivery_place_name ,CASE a.incoming_order_data_type WHEN 'A' THEN '' WHEN 'K' THEN COALESCE(f.delivery_place_code,'') WHEN 'C' THEN COALESCE(f.delivery_place_code,'') ELSE '' END AS 客先delivery_place_code ,CASE a.incoming_order_data_type WHEN 'A' THEN COALESCE(e.delivery_place_name,'') WHEN 'K' THEN COALESCE(f.delivery_place_name,'') WHEN 'C' THEN COALESCE(f.delivery_place_name,'') ELSE '' END AS 客先delivery_place_name ,a.next_process_code ,a.next_process_name ,CASE a.incoming_order_data_type WHEN 'A' THEN COALESCE(e.next_process_place_code,'') WHEN 'K' THEN COALESCE(f.next_process_place_code,'') WHEN 'C' THEN COALESCE(f.next_process_place_code,'') ELSE '' END AS 客先next_process_code ,CASE a.incoming_order_data_type WHEN 'A' THEN COALESCE(e.next_process_name,'') WHEN 'K' THEN COALESCE(f.next_process_name,'') WHEN 'C' THEN COALESCE(f.next_process_name,'') ELSE '' END AS 客先next_process_name ,a.biller ,COALESCE(g.bucket_infomation,'') AS 納入バケット ,'' AS packing_type ,a.placing_order_remarks_1 ,a.placing_order_remarks_type_1 ,a.placing_order_remarks_2 ,a.placing_order_remarks_type_2 ,a.request_remarks_1 ,a.request_remarks_type_1 ,a.request_remarks_2 ,a.request_remarks_type_2 ,a.delivery_remarks_1 ,a.delivery_remarks_2 ,a.version_no ,a.tapered_screw_type ,CASE a.incoming_order_data_type WHEN 'A' THEN COALESCE(CASE e.supply_prospected_DATE WHEN '0' THEN '' WHEN '00000000' THEN '' ELSE e.supply_prospected_DATE END,'') WHEN 'K' THEN COALESCE(CASE f.supply_prospected_DATE WHEN '0' THEN '' WHEN '00000000' THEN '' ELSE f.supply_prospected_DATE END,'') WHEN 'C' THEN COALESCE(CASE f.supply_prospected_DATE WHEN '0' THEN '' WHEN '00000000' THEN '' ELSE f.supply_prospected_DATE END,'') ELSE '' END AS supply_prospected_DATE ,a.test_report_attached_type FROM t_incoming_orders AS a LEFT OUTER JOIN m_customers AS b ON b.customer_code = a.customer_code LEFT OUTER JOIN ( SELECT DISTINCT part_no FROM t_drawings WHERE drawing_type = '1' ) AS c ON c.part_no = a.part_no LEFT OUTER JOIN m_employees AS d ON d.employee_code = a.manager_code LEFT OUTER JOIN t_kobai_juchu AS e ON e.report_no = a.incoming_order_barcode_no LEFT OUTER JOIN t_kogo AS f ON f.issue_INT AUTO_INCREMENT_no = a.incoming_order_barcode_no LEFT OUTER JOIN m_delivery_buckets AS g ON g.biller = a.biller AND g.next_process_code = a.next_process_code WHERE management_no = CAST(? as INT)


