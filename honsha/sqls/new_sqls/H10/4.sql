-- SQL_GET_COPY
SELECT a.management_no ,a.customer_code ,COALESCE(b.customer_name,'') AS customer_name ,CASE WHEN a.customer_code = '1' THEN '1' ELSE '0' END as 得意先区分 ,'' AS incoming_order_no ,'' AS branch_no ,a.part_no ,a.engineering_change_no ,a.part_name ,a.customer_part_no ,CASE WHEN c.part_no IS NULL THEN '' ELSE '管理図面' END AS 図面type ,a.manager_code ,COALESCE(d.employee_name,'') AS manager_name ,a.incoming_order_type ,a.redelivery_type ,NULL AS incoming_order_DATE ,NULL AS deadline ,a.incoming_order_quantity ,a.unit ,a.unit_price ,a.delivery_place_code ,a.delivery_place_name ,'' AS 客先delivery_place_code ,'' AS 客先delivery_place_name ,a.next_process_code ,a.next_process_name ,'' AS 客先next_process_code ,'' AS 客先next_process_name ,a.biller ,COALESCE(e.bucket_infomation,'') AS 納入バケット ,'' AS packing_type ,CASE WHEN a.placing_order_remarks_type_1 = true THEN '' ELSE a.placing_order_remarks_1 END AS placing_order_remarks_1 ,0 AS placing_order_remarks_type_1 ,CASE WHEN a.placing_order_remarks_type_2 = true THEN '' ELSE a.placing_order_remarks_2 END AS placing_order_remarks_2 ,0 AS placing_order_remarks_type_2 ,CASE WHEN a.request_remarks_type_1 = true THEN '' ELSE a.request_remarks_1 END AS request_remarks_1 ,0 AS request_remarks_type_1 ,CASE WHEN a.request_remarks_type_2 = true THEN '' ELSE a.request_remarks_2 END AS request_remarks_2 ,0 AS request_remarks_type_2 ,'' AS delivery_remarks_1 ,'' AS delivery_remarks_2 ,a.version_no ,a.tapered_screw_type ,'' AS supply_prospected_DATE ,a.test_report_attached_type FROM t_incoming_orders AS a LEFT OUTER JOIN m_customers AS b ON b.customer_code = a.customer_code LEFT OUTER JOIN t_drawings AS c ON c.part_no = a.part_no AND c.drawing_type = '1' LEFT OUTER JOIN m_employees AS d ON d.employee_code = a.manager_code LEFT OUTER JOIN m_delivery_buckets AS e ON e.biller = a.biller AND e.next_process_code = a.next_process_code WHERE management_no = CAST(? as INT)


