-- SQL_GET_BEFORE_ORDER
SELECT a.management_no ,a.packing_type ,CASE WHEN a.placing_order_remarks_type_1 = false THEN a.placing_order_remarks_1 ELSE '' END AS placing_order_remarks_1 ,CASE WHEN a.placing_order_remarks_type_2 = false THEN a.placing_order_remarks_2 ELSE '' END AS placing_order_remarks_2 ,CASE WHEN a.request_remarks_type_1 = false THEN a.request_remarks_1 ELSE '' END AS request_remarks_1 ,CASE WHEN a.request_remarks_type_2 = false THEN a.request_remarks_2 ELSE '' END AS request_remarks_2 ,a.tapered_screw_type ,a.manager_code ,a.test_report_attached_type FROM t_incoming_orders AS a INNER JOIN ( SELECT part_no ,MAX(incoming_order_DATE) AS incoming_order_DATE FROM t_incoming_orders WHERE incoming_order_type <> '4' GROUP BY part_no ) AS b ON b.part_no = a.part_no AND b.incoming_order_DATE = a.incoming_order_DATE WHERE a.part_no = ? AND a.engineering_change_no = ? LIMIT 1
