-- SQL_REPORT_SHIRE_HENPIN
SELECT a.supplier_code ,COALESCE(b.supplier_name,'') AS supplier_name ,CASE WHEN a.purchase_category_type = '1' THEN a.material_name ELSE a.part_no END AS part_no ,CASE WHEN a.purchase_category_type = '1' THEN '' ELSE a.engineering_change_no END AS engineering_change_no ,CASE WHEN a.purchase_category_type = '1' THEN a.shape ELSE a.part_name END AS part_name ,CASE WHEN a.purchase_category_type = '1' THEN a.weight ELSE a.quantity END AS quantity ,CASE WHEN a.purchase_category_type = '1' THEN CASE WHEN a.material_unit = '1' THEN '㎏' ELSE '本' END ELSE '' END AS unit ,a.unit_price ,- a.price AS price ,a.remarks AS remarks_1 ,'return_DATE：' || TO_CHAR(a.deal_DATE, 'YYYY/MM/DD') AS remarks_2 FROM t_purchases AS a LEFT OUTER JOIN m_suppliers AS b ON b.supplier_code = a.supplier_code WHERE seq_no = CAST(? AS INT)
