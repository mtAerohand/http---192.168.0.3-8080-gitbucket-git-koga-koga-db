-- SQL_GET_PROCESS
SELECT a.placing_order_no ,a.management_no ,a.process_sort_no ,b.incoming_order_no ,b.branch_no ,b.part_no ,b.engineering_change_no ,b.part_name ,a.supplier_code ,COALESCE(e.supplier_name,'') AS supplier_name ,a.process_code ,COALESCE(f.process_name,'') AS process_name ,a.placing_order_DATE ,a.deadline ,a.final_process_type ,COALESCE(c.partial_delivery_no,1) AS partial_delivery_no ,COALESCE(c.acceptance_DATE,CURRENT_DATE) AS acceptance_DATE ,a.placing_order_quantity ,a.placing_order_quantity - COALESCE(d.総acceptance_quantity,0) AS 発注残数 ,c.acceptance_quantity ,COALESCE(c.acceptance_form_type,'1') AS acceptance_form_type ,c.unit_price ,c.price ,c.version_no FROM t_placing_orders AS a INNER JOIN t_incoming_orders AS b ON b.management_no = a.management_no LEFT OUTER JOIN t_process_acceptances AS c ON c.placing_order_no = a.placing_order_no AND c.partial_delivery_no = CAST(? AS INT) LEFT OUTER JOIN ( SELECT placing_order_no,SUM(acceptance_quantity) AS 総acceptance_quantity FROM t_process_acceptances GROUP BY placing_order_no) AS d ON d.placing_order_no = a.placing_order_no LEFT OUTER JOIN m_suppliers AS e ON e.supplier_code = a.supplier_code LEFT OUTER JOIN m_processes AS f ON f.process_code = a.process_code WHERE a.placing_order_no = CAST(? AS INT)


