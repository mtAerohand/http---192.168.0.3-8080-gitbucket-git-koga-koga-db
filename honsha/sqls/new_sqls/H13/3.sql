-- SQL_GET_PRECEDE
SELECT a.management_no ,a.part_no ,a.engineering_change_no ,a.part_name ,a.incoming_order_DATE ,COALESCE(b.incoming_order_no_and_code,'') AS incoming_order_no_and_code ,CASE WHEN b.registration_DATE IS NULL THEN TO_CHAR(CURRENT_TIMESTAMP, 'YYMMDD') || '-XXX' ELSE TO_CHAR(b.registration_DATE, 'YYMMDD') || '-XXX' END AS incoming_order_no固定部 ,a.manager_code ,COALESCE(c.employee_name,'') AS manager_name ,b.partial_delivery_no ,b.deadline ,b.production_quantity ,b.demand_type ,b.remarks ,b.registration_DATE FROM t_incoming_orders AS a LEFT OUTER JOIN t_preceding_arrangements AS b ON b.incoming_order_DATE = a.incoming_order_DATE AND b.part_no = a.part_no AND b.engineering_change_no = a.engineering_change_no LEFT OUTER JOIN m_employees AS c ON c.employee_code = a.manager_code WHERE a.management_no = CAST(? as INT) ORDER BY b.partial_delivery_no
