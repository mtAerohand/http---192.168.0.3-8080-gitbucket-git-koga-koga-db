-- SQL_GET_REPORT
SELECT a.management_no ,a.incoming_order_no ,a.branch_no ,a.part_no ,a.engineering_change_no ,a.part_name ,a.customer_code ,COALESCE(h.customer_name,'') AS customer_name ,COALESCE(b.customer_manager_name,'') AS customer_manager_name ,COALESCE(b.delivery_place_name,a.delivery_place_name) AS delivery_place_name ,COALESCE(b.ship_service_type,'1') AS ship_service_type ,c.response_DATE ,COALESCE(b.ship_DATE,'') AS ship_DATE ,COALESCE(b.test_DATE,'') AS test_DATE ,c.prospected_delivery_quantity ,COALESCE(b.delivery_form_type,'1') AS delivery_form_type ,CASE WHEN b.final_supplier_code IS NOT NULL THEN COALESCE(i.supplier_name,'') ELSE COALESCE(f.supplier_name,'') END AS 最終加工先名 ,COALESCE(b.arrive_DATE, COALESCE(g.response_DATE,d.deadline)) AS arrive_DATE ,COALESCE(b.arrive_time,'') AS arrive_time ,COALESCE(b.remarks,'') AS remarks ,COALESCE(b.request_DATE,CURRENT_DATE) AS request_DATE ,COALESCE(b.issuer_name,'') AS issuer_name ,COALESCE(b.version_no,0) AS version_no ,COALESCE(b.final_supplier_code,COALESCE(d.supplier_code,'')) AS final_supplier_code FROM t_incoming_orders AS a LEFT OUTER JOIN t_delivery_requests AS b ON b.management_no = a.management_no AND b.partial_delivery_no = CAST(? as INT) LEFT OUTER JOIN m_suppliers as i ON i.supplier_code = b.final_supplier_code LEFT OUTER JOIN t_deadline_responses AS c ON c.management_no = a.management_no AND c.partial_delivery_no = CAST(? as INT) LEFT OUTER JOIN t_placing_orders AS d ON d.management_no = a.management_no AND d.final_process_type = true LEFT OUTER JOIN m_suppliers AS f ON f.supplier_code = d.supplier_code LEFT OUTER JOIN t_deadline_response_requests AS g ON g.management_no = d.management_no AND g.process_sort_no = d.process_sort_no AND g.partial_delivery_no = CAST(? as INT) LEFT OUTER JOIN m_customers AS h ON h.customer_code = a.customer_code WHERE a.management_no = CAST(? as INT)


