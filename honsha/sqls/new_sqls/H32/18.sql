-- SQL_GET_CUSTOMER
SELECT * FROM ( SELECT CASE WHEN x.management_no IS NOT NULL THEN x.management_no ELSE y.management_no END AS management_no ,CASE WHEN x.partial_delivery_no IS NOT NULL THEN X.partial_delivery_no ELSE y.partial_delivery_no END AS partial_delivery_no ,x.response_DATE種別 ,x.response_DATE ,x.response_DATE色区分 ,x.prospected_delivery_quantity ,y.delivery_DATE ,y.納quantity ,x.納入request_DATE ,y.ship_type ,y.test出荷request_DATE ,y.test完了日 ,y.testship_request_quantity FROM ( SELECT CASE WHEN a.management_no IS NOT NULL THEN a.management_no ELSE b.management_no END AS management_no ,CASE WHEN a.partial_delivery_no IS NOT NULL THEN a.partial_delivery_no ELSE b.partial_delivery_no END AS partial_delivery_no ,CASE COALESCE(a.response_DATE_type,'') WHEN '1' THEN '営回' WHEN '2' THEN '営発' WHEN '3' THEN '客回' WHEN '4' THEN '客発' ELSE '' END AS response_DATE種別 ,a.response_DATE ,CASE COALESCE(a.response_DATE_type,'') WHEN '1' THEN '0' /* 営回(black) */ WHEN '2' THEN '0' /* 営発(black) */ WHEN '3' THEN '2' /* 客回(blue) */ WHEN '4' THEN '1' /* 客発(red) */ ELSE '0' END AS response_DATE色区分 ,a.prospected_delivery_quantity ,b.request_DATE AS 納入request_DATE FROM t_deadline_responses AS a FULL OUTER JOIN t_delivery_requests AS b ON b.management_no = a.management_no AND b.partial_delivery_no = a.partial_delivery_no ) AS x FULL OUTER JOIN ( SELECT CASE WHEN c.management_no IS NOT NULL THEN c.management_no ELSE d.management_no END AS management_no ,CASE WHEN c.partial_delivery_no IS NOT NULL THEN c.partial_delivery_no ELSE d.partial_delivery_no END AS partial_delivery_no ,CASE COALESCE(c.ship_type,'') WHEN '1' THEN '振替出荷' WHEN '2' THEN '在庫出荷' WHEN '3' THEN '通常出荷' ELSE '' END AS ship_type ,c.request_DATE AS test出荷request_DATE ,c.request_quantity AS testship_request_quantity ,c.result_registration_DATE AS test完了日 ,d.delivery_DATE ,d.request_quantity AS 納quantity FROM t_test_and_ship_requests AS c FULL OUTER JOIN t_sales AS d ON d.management_no = c.management_no AND d.partial_delivery_no = c.partial_delivery_no ) AS y ON y.management_no = x.management_no AND y.partial_delivery_no = x.partial_delivery_no ) AS z WHERE z.management_no = CAST(? as INT) ORDER BY z.partial_delivery_no


