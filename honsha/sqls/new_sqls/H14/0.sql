-- SQL_GET_ALL
SELECT a.seq_no ,a.incoming_order_no_and_code || TO_CHAR(a.registration_DATE, 'YYMMDD') || '-' AS incoming_order_no ,a.part_no ,a.engineering_change_no ,a.deadline ,a.production_quantity ,CASE a.demand_type WHEN true THEN '有' ELSE '' END AS 督促有無 ,a.remarks ,a.manager_code ,COALESCE(b.employee_name,'') AS manager_name ,c.management_no FROM t_preceding_arrangements AS a LEFT OUTER JOIN m_employees AS b ON b.employee_code = a.manager_code LEFT OUTER JOIN ( SELECT part_no ,engineering_change_no ,MAX(management_no) AS management_no FROM t_incoming_orders WHERE incoming_order_type = '1' GROUP BY part_no, engineering_change_no ) AS c ON c.part_no = a.part_no AND c.engineering_change_no = a.engineering_change_no WHERE a.registration_DATE = CAST(? as DATE) ORDER BY a.part_no, a.partial_delivery_no
