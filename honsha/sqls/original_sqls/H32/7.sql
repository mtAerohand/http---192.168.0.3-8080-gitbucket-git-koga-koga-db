-- SQL_GET_REPORT
SELECT a.管理No ,a.受注番号 ,a.枝番 ,a.品番 ,a.設変番号 ,a.品名 ,a.得意先コード ,COALESCE(h.得意先名,'') AS 得意先名 ,COALESCE(b.得意先担当者名,'') AS 得意先担当者名 ,COALESCE(b.納入場所名,a.納入場所名) AS 納入場所名 ,COALESCE(b.出荷便区分,'1') AS 出荷便区分 ,c.回答日 ,COALESCE(b.出荷日,'') AS 出荷日 ,COALESCE(b.検査日,'') AS 検査日 ,c.予定納入数 ,COALESCE(b.納入形態区分,'1') AS 納入形態区分 ,CASE WHEN b.最終加工先コード IS NOT NULL THEN COALESCE(i.作業区名,'') ELSE COALESCE(f.作業区名,'') END AS 最終加工先名 ,COALESCE(b.入荷日, COALESCE(g.回答日,d.納期)) AS 入荷日 ,COALESCE(b.入荷時刻,'') AS 入荷時刻 ,COALESCE(b.備考,'') AS 備考 ,COALESCE(b.依頼日,CURRENT_DATE) AS 依頼日 ,COALESCE(b.発行者名,'') AS 発行者名 ,COALESCE(b.バージョン番号,0) AS バージョン番号 ,COALESCE(b.最終加工先コード,COALESCE(d.作業区コード,'')) AS 最終加工先コード FROM T_受注 AS a LEFT OUTER JOIN T_納入依頼 AS b ON b.管理No = a.管理No AND b.分納No = CAST(? as INT) LEFT OUTER JOIN M_作業区仕入先 as i ON i.作業区コード = b.最終加工先コード LEFT OUTER JOIN T_納期回答 AS c ON c.管理No = a.管理No AND c.分納No = CAST(? as INT) LEFT OUTER JOIN T_発注 AS d ON d.管理No = a.管理No AND d.最終工程区分 = true LEFT OUTER JOIN M_作業区仕入先 AS f ON f.作業区コード = d.作業区コード LEFT OUTER JOIN T_納期回答依頼 AS g ON g.管理No = d.管理No AND g.工程順序No = d.工程順序No AND g.分納No = CAST(? as INT) LEFT OUTER JOIN M_得意先 AS h ON h.得意先コード = a.得意先コード WHERE a.管理No = CAST(? as INT)


