-- SQL_GET
SELECT a.管理No ,a.得意先コード ,COALESCE(b.得意先名,'') AS 得意先名 ,CASE WHEN a.得意先コード = '1' THEN '1' ELSE '0' END as 得意先区分 ,a.受注番号 ,a.枝番 ,a.品番 ,a.設変番号 ,a.品名 ,a.客先品番 ,CASE WHEN c.品番 IS NULL THEN '' ELSE '管理図面' END AS 図面分類 ,a.担当者コード ,COALESCE(d.社員名,'') AS 担当者名 ,a.受注区分 ,a.再納区分 ,a.受注日 ,a.納期 ,a.受注数 ,a.単位 ,a.単価 ,a.納入場所コード ,a.納入場所名 ,CASE a.注文データ区分 WHEN 'A' THEN '' WHEN 'K' THEN COALESCE(f.納入場所コード,'') WHEN 'C' THEN COALESCE(f.納入場所コード,'') ELSE '' END AS 客先納入場所コード ,CASE a.注文データ区分 WHEN 'A' THEN COALESCE(e.納入場所名,'') WHEN 'K' THEN COALESCE(f.納入場所名,'') WHEN 'C' THEN COALESCE(f.納入場所名,'') ELSE '' END AS 客先納入場所名 ,a.次工程コード ,a.次工程名 ,CASE a.注文データ区分 WHEN 'A' THEN COALESCE(e.次工程先コード,'') WHEN 'K' THEN COALESCE(f.次工程先コード,'') WHEN 'C' THEN COALESCE(f.次工程先コード,'') ELSE '' END AS 客先次工程コード ,CASE a.注文データ区分 WHEN 'A' THEN COALESCE(e.次工程名,'') WHEN 'K' THEN COALESCE(f.次工程名,'') WHEN 'C' THEN COALESCE(f.次工程名,'') ELSE '' END AS 客先次工程名 ,a.請求元 ,COALESCE(g.バケット情報,'') AS 納入バケット ,'' AS 梱包区分 ,a.発注備考1 ,a.発注備考区分1 ,a.発注備考2 ,a.発注備考区分2 ,a.依頼備考1 ,a.依頼備考区分1 ,a.依頼備考2 ,a.依頼備考区分2 ,a.納入備考1 ,a.納入備考2 ,a.バージョン番号 ,a.テーパーおねじ区分 ,CASE a.注文データ区分 WHEN 'A' THEN COALESCE(CASE e.支給予定日 WHEN '0' THEN '' WHEN '00000000' THEN '' ELSE e.支給予定日 END,'') WHEN 'K' THEN COALESCE(CASE f.支給予定日 WHEN '0' THEN '' WHEN '00000000' THEN '' ELSE f.支給予定日 END,'') WHEN 'C' THEN COALESCE(CASE f.支給予定日 WHEN '0' THEN '' WHEN '00000000' THEN '' ELSE f.支給予定日 END,'') ELSE '' END AS 支給予定日 ,a.検査表添付区分 FROM T_受注 AS a LEFT OUTER JOIN M_得意先 AS b ON b.得意先コード = a.得意先コード LEFT OUTER JOIN ( SELECT DISTINCT 品番 FROM T_図面 WHERE 図面種類 = '1' ) AS c ON c.品番 = a.品番 LEFT OUTER JOIN M_社員 AS d ON d.社員コード = a.担当者コード LEFT OUTER JOIN T_購買伝票受注 AS e ON e.帳票番号 = a.注文バーコード番号 LEFT OUTER JOIN T_工号生産納入指示 AS f ON f.発行連番 = a.注文バーコード番号 LEFT OUTER JOIN M_納入バケット AS g ON g.請求元 = a.請求元 AND g.次工程コード = a.次工程コード WHERE 管理No = CAST(? as INT)


